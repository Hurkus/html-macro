<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<title>Macro example!</title>
</head>
<body>
	<SET z="" x="2" y="x + 1" _pi="pi" />
	
	<!-- Call tests -->
	<CALL NAME="title" />
	<h2 CALL="subtitle"></h2>
	
	<!-- Branching test -->
	<IF TRUE="x+1 <= y">
		<INFO>passed with x={x} and y={y}</INFO>
	</IF>
	<ELSE>
		<INFO>failed with x={x} and y={y}</INFO>
	</ELSE>
	
	<!-- Attr conditional test -->
	<WARN IF="z == 0">z not set</WARN>
	<p IF="z">z-index of page is {z}</p>
	<p IF="!z">z-index of page is missing!</p>
	
	<!-- Shell tests -->
	<p>
		<SHELL VARS="x,y">echo -n "$x * $y == $((x * y))"</SHELL>
	</p>
	<SHELL VARS="x,y" STDOUT="z">echo "$((x * y))"</SHELL>
	<SHELL VARS="x,y" STDOUT="HTML">echo -n '<span CALL="print-z"></span>'</SHELL>
	
	<!-- Loop tests -->
	<ul>
		<FOR i="0" TRUE="i <= 2" i="i+1">
			<li>Item: {i}</li>
		</FOR>
		<WHILE TRUE="i < 5">
			<li>Item: {i}</li>
			<SET i="i+1" />
		</WHILE>
	</ul>
	
	<!-- Set* tests -->
	<div class="box">
		<SET x="x-1" />
		<SET-TAG NAME="img"/>
		<SET-ATTR IF="x < 2" src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/de/Nokota_Horses_cropped.jpg/250px-Nokota_Horses_cropped.jpg"/>
		<SET-ATTR IF="x >= 2" src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bf/Bucephala-albeola-010.jpg/960px-Bucephala-albeola-010.jpg"/>
		<DEL-ATTR NAME="class"/>
		<GET-ATTR src="src"/>
		<CALL NAME="ff-size"/>
		<SET-ATTR width="{int(w)}" height="{int(h)}"/>
	</div>
	
</body>
</html>

<MACRO NAME="title">
	<h1 data-value="{x*2}">This is a page!</h1>
</MACRO>

<MACRO NAME="subtitle">Pages {x} and {y + 0.1}</MACRO>

<MACRO NAME="print-z">new z index is {int(z)}</MACRO>

<MACRO NAME="ff-size">
	<!-- w and h have newline after because of ffprobe, use int(w) or int(h) to cast to integer -->
	<SHELL VARS="src" STDOUT="w">ffprobe -v error -hide_banner -show_entries stream=width -of csv=p=0 -i "$src"</SHELL>
	<SHELL VARS="src" STDOUT="h">ffprobe -v error -hide_banner -show_entries stream=height -of csv=p=0 -i "$src"</SHELL>
	<INFO>{src}: {int(w)},{int(h)}</INFO>
</MACRO>
